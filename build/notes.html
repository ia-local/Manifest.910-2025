<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes AG 30 Septembre</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-color: #f8f9fa;
            --card-background: #ffffff;
            --text-color: #343a40;
            --border-color: #dee2e6;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 600px;
            padding: 1rem;
            box-sizing: border-box;
        }

        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            box-shadow: 0 4px 6px var(--shadow-color);
            margin-bottom: 1rem;
        }

        .header h1 {
            margin: 0;
            font-size: 1.5rem;
        }

        .note-card {
            background-color: var(--card-background);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px var(--shadow-color);
            border: 1px solid var(--border-color);
        }

        .note-card h2 {
            margin-top: 0;
            font-size: 1.25rem;
            color: var(--secondary-color);
        }

        .note-card p {
            margin: 0.5rem 0;
        }
        
        .note-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
            margin-top: 1rem;
        }

        .form-container {
            width: 100%;
            max-width: 600px;
            padding: 1rem;
            box-sizing: border-box;
            background-color: var(--card-background);
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px var(--shadow-color);
            border: 1px solid var(--border-color);
            margin-top: 1rem;
            display: none; /* Caché par défaut */
            flex-direction: column;
            gap: 1rem;
            animation: fadeIn 0.5s ease-in-out;
        }

        .form-container.visible {
            display: flex; /* Affiché quand la classe 'visible' est ajoutée */
        }
        
        .form-container label {
            font-weight: 600;
        }

        .form-container textarea, .form-container select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            resize: vertical;
        }
        
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 6px var(--shadow-color);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .btn:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-danger {
            background-color: #dc3545;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .navigation {
            width: 100%;
            background-color: white;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color);
            box-shadow: 0 2px 4px var(--shadow-color);
            display: flex;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .navigation-links {
            display: flex;
            gap: 1rem;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .navigation-links a {
            text-decoration: none;
            color: var(--secondary-color);
            font-weight: 600;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s ease;
        }

        .navigation-links a:hover, .navigation-links a.active {
            background-color: #e9ecef;
            color: var(--primary-color);
        }

        /* Styles pour masquer/afficher les sections */
        .notes-section {
            display: none;
        }

        .notes-section.active {
            display: block;
        }

        /* Animation pour l'apparition du formulaire */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Styles spécifiques pour les écrans plus grands */
        @media (min-width: 600px) {
            .container, .form-container {
                padding: 2rem;
            }
            .header h1 {
                font-size: 2rem;
            }
            .note-card {
                padding: 2rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navigation">
        <ul class="navigation-links">
            <li><a href="#" id="nav-all-notes" class="active">Toutes les notes</a></li>
            <li><a href="#" id="nav-revendications">Revendications</a></li>
            <li><a href="#" id="nav-actions">Actions</a></li>
        </ul>
    </nav>

    <div class="container">
        <header class="header">
            <h1>Notes AG</h1>
            <p>10 Septembre 2025</p>
        </header>

        <!-- Conteneurs pour les notes classées -->
        <section id="notes-all" class="notes-section active">
            <!-- Les notes seront ajoutées ici dynamiquement -->
        </section>
        
        <section id="notes-revendications" class="notes-section">
            <!-- Les notes de revendications seront ajoutées ici -->
        </section>
        
        <section id="notes-actions" class="notes-section">
            <!-- Les notes d'actions seront ajoutées ici -->
        </section>

        <!-- Formulaire de saisie de note, caché par défaut -->
        <div id="note-form-container" class="form-container">
            <input type="hidden" id="note-id">
            <label for="note-category">Catégorie :</label>
            <select id="note-category">
                <option value="revendications">Revendications</option>
                <option value="actions">Actions</option>
            </select>
            <label for="note-content">Contenu de la note :</label>
            <textarea id="note-content" rows="4" placeholder="Tapez votre note ici..."></textarea>
            <div class="btn-group">
                <button id="cancel-note-btn" class="btn btn-secondary">Annuler</button>
                <button id="save-note-btn" class="btn">Enregistrer la note</button>
            </div>
        </div>
    </div>

    <!-- Boutons d'action en bas de la page -->
    <div class="container" style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
        <button id="show-form-btn" class="btn" style="width: 100%;">Ajouter une note</button>
        <button id="export-btn" class="btn btn-secondary" style="width: 100%;">Exporter les notes</button>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Références des éléments du DOM
            const showFormBtn = document.getElementById('show-form-btn');
            const noteFormContainer = document.getElementById('note-form-container');
            const noteContentTextarea = document.getElementById('note-content');
            const noteCategorySelect = document.getElementById('note-category');
            const noteIdInput = document.getElementById('note-id');
            const cancelNoteBtn = document.getElementById('cancel-note-btn');
            const saveNoteBtn = document.getElementById('save-note-btn');
            const exportBtn = document.getElementById('export-btn');
            const notesContainers = {
                all: document.getElementById('notes-all'),
                revendications: document.getElementById('notes-revendications'),
                actions: document.getElementById('notes-actions')
            };
            
            // Références pour la navigation
            const navLinks = document.querySelectorAll('.navigation-links a');
            const noteSections = document.querySelectorAll('.notes-section');
            
            let notesData = []; // Tableau pour stocker les notes
            let nextNoteId = 1;

            // Fonction pour sauvegarder les notes dans localStorage
            const saveNotes = () => {
                localStorage.setItem('notesData', JSON.stringify(notesData));
                localStorage.setItem('nextNoteId', nextNoteId.toString());
            };

            // Fonction pour charger les notes depuis localStorage
            const loadNotes = () => {
                const storedNotes = localStorage.getItem('notesData');
                const storedId = localStorage.getItem('nextNoteId');
                if (storedNotes) {
                    try {
                        notesData = JSON.parse(storedNotes);
                        if (!Array.isArray(notesData)) {
                             notesData = []; // Réinitialiser si le format est incorrect
                        }
                    } catch (e) {
                        console.error('Erreur lors du chargement des notes depuis localStorage:', e);
                        notesData = [];
                    }
                }
                if (storedId) {
                    nextNoteId = parseInt(storedId);
                }
            };
            
            // Fonction pour afficher le formulaire
            const showForm = () => {
                noteFormContainer.classList.add('visible');
                showFormBtn.style.display = 'none';
                noteContentTextarea.focus();
            };

            // Fonction pour cacher le formulaire
            const hideForm = () => {
                noteFormContainer.classList.remove('visible');
                showFormBtn.style.display = 'block';
                noteContentTextarea.value = '';
                noteIdInput.value = '';
            };

            // Fonction pour afficher une alerte temporaire
            const showTemporaryMessage = (message, isError = false) => {
                const messageBox = document.createElement('div');
                messageBox.className = 'note-card';
                if (isError) {
                     messageBox.style.backgroundColor = '#f8d7da';
                     messageBox.style.color = '#721c24';
                }
                messageBox.innerHTML = `<h2>${isError ? 'Erreur' : 'Information'}</h2><p>${message}</p>`;
                notesContainers.all.insertBefore(messageBox, notesContainers.all.firstChild);
                setTimeout(() => messageBox.remove(), 3000);
            };
            
            // Fonction pour créer l'élément HTML d'une note
            const createNoteElement = (note) => {
                const newNote = document.createElement('section');
                newNote.className = 'note-card';
                newNote.dataset.noteId = note.id;
                newNote.dataset.noteCategory = note.category;
                newNote.innerHTML = `
                    <h2>Note (${note.category})</h2>
                    <p>${note.content}</p>
                    <div class="note-actions">
                        <button class="btn btn-secondary edit-btn">Modifier</button>
                        <button class="btn btn-danger delete-btn">Supprimer</button>
                    </div>
                `;
                return newNote;
            };

            // Fonction pour rendre toutes les notes
            const renderNotes = () => {
                // Vider les conteneurs existants
                notesContainers.all.innerHTML = '';
                notesContainers.revendications.innerHTML = '';
                notesContainers.actions.innerHTML = '';
                
                notesData.forEach(note => {
                    const noteElement = createNoteElement(note);
                    notesContainers.all.appendChild(noteElement.cloneNode(true));
                    
                    if (note.category === 'revendications') {
                        notesContainers.revendications.appendChild(noteElement.cloneNode(true));
                    } else if (note.category === 'actions') {
                        notesContainers.actions.appendChild(noteElement.cloneNode(true));
                    }
                });
            };

            // Événement pour afficher le formulaire
            showFormBtn.addEventListener('click', showForm);

            // Événement pour annuler la saisie et cacher le formulaire
            cancelNoteBtn.addEventListener('click', hideForm);

            // Événement pour enregistrer ou modifier la note
            saveNoteBtn.addEventListener('click', () => {
                const noteContent = noteContentTextarea.value.trim();
                const noteCategory = noteCategorySelect.value;
                const noteId = noteIdInput.value;

                if (noteContent === '') {
                    showTemporaryMessage('La note ne peut pas être vide. Veuillez saisir du texte.', true);
                    return;
                }

                if (noteId) {
                    // Mode modification
                    const index = notesData.findIndex(note => note.id === parseInt(noteId));
                    if (index !== -1) {
                        notesData[index].content = noteContent;
                        notesData[index].category = noteCategory;
                        showTemporaryMessage('Note modifiée avec succès.');
                    }
                } else {
                    // Mode ajout
                    notesData.push({
                        id: nextNoteId++,
                        content: noteContent,
                        category: noteCategory
                    });
                    showTemporaryMessage('Note ajoutée avec succès.');
                }
                
                renderNotes();
                saveNotes();
                hideForm();
            });

            // Événement pour la modification et la suppression (via la délégation d'événement)
            notesContainers.all.addEventListener('click', (event) => {
                const target = event.target;
                const noteCard = target.closest('.note-card');
                if (!noteCard) return;

                const noteId = parseInt(noteCard.dataset.noteId);
                
                if (target.classList.contains('edit-btn')) {
                    // Mode modification
                    const noteToEdit = notesData.find(note => note.id === noteId);
                    if (noteToEdit) {
                        noteContentTextarea.value = noteToEdit.content;
                        noteCategorySelect.value = noteToEdit.category;
                        noteIdInput.value = noteToEdit.id;
                        showForm();
                    }
                } else if (target.classList.contains('delete-btn')) {
                    // Mode suppression
                    notesData = notesData.filter(note => note.id !== noteId);
                    renderNotes();
                    saveNotes();
                    showTemporaryMessage('Note supprimée avec succès.');
                }
            });

            // Logique pour la navigation
            navLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    navLinks.forEach(item => item.classList.remove('active'));
                    link.classList.add('active');
                    
                    const targetId = link.id.replace('nav-', 'notes-');
                    noteSections.forEach(section => {
                        if (section.id === targetId) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    });
                });
            });

            // Événement d'exportation au format Markdown
            exportBtn.addEventListener('click', () => {
                let markdownContent = `# Notes d'Assemblée Générale\n\n`;
                notesData.forEach(note => {
                    markdownContent += `## ${note.category.charAt(0).toUpperCase() + note.category.slice(1)}\n\n`;
                    markdownContent += `${note.content}\n\n`;
                });
                
                const dataUri = 'data:text/markdown;charset=utf-8,' + encodeURIComponent(markdownContent);
                
                const exportFileDefaultName = 'notes.md';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                showTemporaryMessage('Notes exportées dans notes.md.');
            });

            // Initialisation de l'application
            // Les données sont maintenant injectées directement dans le script
            notesData = [
                { id: 1, content: "Lancer une pétition pour le droit de grève.", category: "revendications" },
                { id: 2, content: "Contactez les médias locaux pour couvrir la manifestation.", category: "actions" },
                { id: 3, content: "Demander une augmentation de 5% des salaires pour tous les employés.", category: "revendications" },
                { id: 4, content: "Organiser une réunion avec les délégués syndicaux la semaine prochaine.", category: "actions" }
            ];
            nextNoteId = notesData.length + 1;
            renderNotes();
        });
    </script>
</body>
</html>
